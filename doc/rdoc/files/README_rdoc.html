<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>File: README.rdoc</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



  <div id="fileHeader">
    <h1>README.rdoc</h1>
    <table class="header-table">
    <tr class="top-aligned-row">
      <td><strong>Path:</strong></td>
      <td>README.rdoc
      </td>
    </tr>
    <tr class="top-aligned-row">
      <td><strong>Last Update:</strong></td>
      <td>Wed Oct 07 02:23:48 -0400 2009</td>
    </tr>
    </table>
  </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <h1><a href="../classes/Markaby.html">Markaby</a> (Markup as Ruby)</h1>
<p>
<a href="../classes/Markaby.html">Markaby</a> is a very short bit of code
for writing HTML pages in pure Ruby. It is an alternative to ERb which
weaves the two languages together. Also a replacement for templating
languages which use primitive languages that blend with HTML.
</p>
<h2>Using <a href="../classes/Markaby.html">Markaby</a> as a Rails plugin</h2>
<p>
Write Rails templates in pure Ruby. Example layout:
</p>
<pre>
  html do
    head do
      title 'Products: ' + action_name
      stylesheet_link_tag 'scaffold'
    end

    body do
      p flash[:notice], :style =&gt; &quot;color: green&quot;

      self &lt;&lt; content_for_layout
    end
  end
</pre>
<p>
<a href="../classes/Markaby.html">Markaby</a> supports many versions of
rails:
</p>
<pre>
  1.2.2, 1.2.3, 1.2.4, 1.2.5, 1.2.6, 2.1.0, 2.1.1, 2.1.2, 2.2.0,
  2.2.1, 2.2.2, 2.2.3, 2.3.1, 2.3.2, 2.3.2.1, 2.3.3, 2.3.3.1, 2.3.4
</pre>
<h2>Using <a href="../classes/Markaby.html">Markaby</a> as a Ruby class</h2>
<p>
<a href="../classes/Markaby.html">Markaby</a> is flaming easy to call from
your Ruby classes.
</p>
<pre>
  require 'markaby'

  mab = Markaby::Builder.new
  mab.html do
    head { title &quot;Boats.com&quot; }
    body do
      h1 &quot;Boats.com has great deals&quot;
      ul do
        li &quot;$49 for a canoe&quot;
        li &quot;$39 for a raft&quot;
        li &quot;$29 for a huge boot that floats and can fit 5 people&quot;
      end
    end
  end
  puts mab.to_s
</pre>
<p>
Markaby::Builder.new does take two arguments for passing in variables and a
helper object. You can also affix the block right on to the class.
</p>
<p>
See <a href="../classes/Markaby/Builder.html">Markaby::Builder</a> for all
of that.
</p>
<h1>A Note About <tt>instance_eval</tt></h1>
<p>
The <a href="../classes/Markaby/Builder.html">Markaby::Builder</a> class is
different from the normal Builder class, since it uses
<tt>instance_eval</tt> when running blocks. This cleans up the appearance
of the <a href="../classes/Markaby.html">Markaby</a> code you write. If
<tt>instance_eval</tt> was not used, the code would look like this:
</p>
<pre>
  mab = Markaby::Builder.new
  mab.html do
    mab.head { mab.title &quot;Boats.com&quot; }
    mab.body do
      mab.h1 &quot;Boats.com has great deals&quot;
    end
  end
  puts mab.to_s
</pre>
<p>
So, the advantage is the cleanliness of your code. The disadvantage is that
the block will run inside the <a
href="../classes/Markaby/Builder.html">Markaby::Builder</a> object&#8216;s
scope. This means that inside these blocks, <tt>self</tt> will be your <a
href="../classes/Markaby/Builder.html">Markaby::Builder</a> object. When
you use instance variables in these blocks, they will be instance variables
of the <a href="../classes/Markaby/Builder.html">Markaby::Builder</a>
object.
</p>
<p>
This doesn&#8216;t affect Rails users, but when used in regular Ruby code,
it can be a bit disorienting. You are recommended to put your <a
href="../classes/Markaby.html">Markaby</a> code in a module where it
won&#8216;t mix with anything.
</p>
<h1>The Six Steps of <a href="../classes/Markaby.html">Markaby</a></h1>
<p>
If you dive right into <a href="../classes/Markaby.html">Markaby</a>,
it&#8216;ll probably make good sense, but you&#8216;re likely to run into a
few kinks. Why not review these six steps and commit them memory so you can
really <b>know</b> what you&#8216;re doing?
</p>
<h2>1. Element Classes</h2>
<p>
Element classes may be added by hooking methods onto container elements:
</p>
<pre>
  div.entry do
    h2.entryTitle 'Son of WebPage'
    div.entrySection %{by Anthony}
    div.entryContent 'Okay, once again, the idea here is ...'
  end
</pre>
<p>
Which results in:
</p>
<pre>
  &lt;div class=&quot;entry&quot;&gt;
    &lt;h2 class=&quot;entryTitle&quot;&gt;Son of WebPage&lt;/h2&gt;
    &lt;div class=&quot;entrySection&quot;&gt;by Anthony&lt;/div&gt;
    &lt;div class=&quot;entryContent&quot;&gt;Okay, once again, the idea here is ...&lt;/div&gt;
  &lt;/div&gt;
</pre>
<h2>2. Element IDs</h2>
<p>
IDs may be added by the use of bang methods:
</p>
<pre>
  div.page! {
    div.content! {
      h1 &quot;A Short Short Saintly Dog&quot;
    }
  }
</pre>
<p>
Which results in:
</p>
<pre>
  &lt;div id=&quot;page&quot;&gt;
    &lt;div id=&quot;content&quot;&gt;
      &lt;h1&gt;A Short Short Saintly Dog&lt;/h1&gt;
    &lt;/div&gt;
  &lt;/div&gt;
</pre>
<h2>3. Validate Your XHTML 1.0 Output</h2>
<p>
If you&#8216;d like <a href="../classes/Markaby.html">Markaby</a> to help
you assemble valid XHTML documents, you can use the
<tt>xhtml_transitional</tt> or <tt>xhtml_strict</tt> methods in place of
the normal <tt>html</tt> tag.
</p>
<pre>
  xhtml_strict do
    head { ... }
    body { ... }
  end
</pre>
<p>
This will add the XML instruction and the doctype tag to your document.
Also, a character set meta tag will be placed inside your <tt>head</tt>
tag.
</p>
<p>
Now, since <a href="../classes/Markaby.html">Markaby</a> knows which
doctype you&#8216;re using, it checks a big list of valid tags and
attributes before printing anything.
</p>
<pre>
  &gt;&gt; div :styl =&gt; &quot;padding: 10px&quot; do
  &gt;&gt;   img :src =&gt; &quot;samorost.jpg&quot;
  &gt;&gt; end
  InvalidHtmlError: no such attribute `styl'
</pre>
<p>
<a href="../classes/Markaby.html">Markaby</a> will also make sure you
don&#8216;t use the same element ID twice!
</p>
<h2>4. Escape or No Escape?</h2>
<p>
<a href="../classes/Markaby.html">Markaby</a> uses a simple convention for
escaping stuff: if a string is an argument, it gets escaped. If the string
is in a block, it doesn&#8216;t.
</p>
<p>
This is handy if you&#8216;re using something like RedCloth or RDoc inside
an element. Pass the string back through the block and it&#8216;ll skip out
of escaping.
</p>
<pre>
  div.comment { RedCloth.new(str).to_html }
</pre>
<p>
But, if we have some raw text that needs escaping, pass it in as an
argument:
</p>
<pre>
  div.comment raw_str
</pre>
<p>
One caveat: if you have other tags inside a block, the string passed back
will be ignored.
</p>
<pre>
  div.comment {
    div.author &quot;_why&quot;
    div.says &quot;Torpedoooooes!&quot;
    &quot;&lt;div&gt;Silence.&lt;/div&gt;&quot;
  }
</pre>
<p>
The final div above won&#8216;t appear in the output. You can&#8216;t mix
tag modes like that, friend.
</p>
<h2>5. Auto-stringification</h2>
<p>
If you end up using any of your <a
href="../classes/Markaby.html">Markaby</a> &quot;tags&quot; as a string,
the tag won&#8216;t be output. It&#8216;ll be up to you to add the new
string back into the HTML output.
</p>
<p>
This means if you call <tt>to_s</tt>, you&#8216;ll get a string back.
</p>
<pre>
  div.title { &quot;Rock Bottom&quot; + span(&quot; by Robert Wyatt&quot;).to_s }
</pre>
<p>
But, when you&#8216;re adding strings in Ruby, <tt>to_s</tt> happens
automatically.
</p>
<pre>
  div.title { &quot;Rock Bottom&quot; + span(&quot; by Robert Wyatt&quot;) }
</pre>
<p>
Interpolation works fine.
</p>
<pre>
  div.title { &quot;Rock Bottom #{span(&quot; by Robert Wyatt&quot;)}&quot; }
</pre>
<p>
And any other operation you might perform on a string.
</p>
<pre>
  div.menu! \
    ['5.gets', 'bits', 'cult', 'inspect', '-h'].map do |category|
      link_to category
    end.
    join( &quot; | &quot; )
</pre>
<h2>6. The <tt>tag!</tt> Method</h2>
<p>
If you need to force a tag at any time, call <tt>tag!</tt> with the tag
name followed by the possible arguments and block. The CssProxy won&#8216;t
work with this technique.
</p>
<pre>
  tag! :select, :id =&gt; &quot;country_list&quot; do
    countries.each do |country|
      tag! :option, country
    end
  end
</pre>
<h1>A Note About Rails Helpers</h1>
<p>
When used in Rails templates, the Rails helper object is passed into <a
href="../classes/Markaby/Builder.html">Markaby::Builder</a>. When you call
helper methods inside <a href="../classes/Markaby.html">Markaby</a>, the
output from those methods will be output to the stream. This is incredibly
handy, since most Rails helpers output HTML tags.
</p>
<pre>
  head do
    javascript_include_tag 'prototype'
    autodiscovery_link_tag
  end
</pre>
<p>
However, some methods are designed to give back a String which you can use
elsewhere. That&#8216;s okay! Every method returns a Fragment object, which
can be used as a string.
</p>
<pre>
  p { &quot;Total is: #{number_to_human_size @file_bytes}&quot; }
</pre>
<p>
Also see the Quick Tour above, specifically the stuff about
auto-stringification.
</p>
<p>
If for any reason you have trouble with fragments, you can just call the
<tt>@helpers</tt> object with the method and you&#8216;ll get the String
back and nothing will be output.
</p>
<pre>
  p { &quot;Total is: #{@helpers.number_to_human_size @file_bytes}&quot; }
</pre>
<p>
Conversely, you may call instance variables from your controller by using a
method and its value will be returned, nothing will be output.
</p>
<pre>
  # Inside imaginary ProductController
  def list
    @products = Product.find :all
  end

  # Inside app/views/product/list.mab
  products.each do |product|
    p product.title
  end
</pre>
<h1>Credits</h1>
<p>
<a href="../classes/Markaby.html">Markaby</a> is a work of immense hope by
Tim Fletcher and why the lucky stiff. It is maintained by joho, spox, and
smtlaissezfaire. Thankyou for giving it a whirl.
</p>
<p>
<a href="../classes/Markaby.html">Markaby</a> is inspired by the HTML
library within cgi.rb. Hopefully it will turn around and take some cues.
</p>

    </div>


   </div>


  </div>


    <!-- if includes -->

    <div id="section">





      


    <!-- if method_list -->


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>